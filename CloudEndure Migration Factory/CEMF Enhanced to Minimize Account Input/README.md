# CEMF Account Entry Enhancements

# Overview

We enhance existing CEMF migration script to minimize user input of CloudEndure Migration Factory account, respective server accounts on both Linux and Windows servers, and CloudEndure installation key. Manually inputting these accounts takes time and prone to user error.

This enhancements will minimize manual input of CEMF account, server accounts, and CloudEndure installation key to improve efficiency of the users.

# Enhancements

## CloudEndure Migration Factory (CEMF) Account Entry

All the scripts that requires CEMF account entry are updated by allowing user to set CEMF username and password in environment variable. If the script detect that there is CEMF account defined in environment variable, it will prompt the user whether to use the account or enter the account manually.

If the environment variables are not set it will behave to its default behavior which is to ask the account.

You must set this environment variable before you execute the script. You don’t need to set it again when you execute another script as long as you do not close and re-open the console. See [How to Verify if the Environment Variable Exists](#_How_to_Verify).

<![endif]-->

### Limitation

The environment variable only exist within the session of the command console. If you open a new command console or you close and re-open the console, you need to re-enter the environment variables again.

### How to Set the Environment Variables

Use _SET_ command of the windows command console to set the environment variable. For CEMF account we have to set the following environment variable.

- CEMF_USERNAME. Your CloudEndure Migration Factory username.
- CEMF_PASSWORD. Your CloudEndure Migration Factory password.

Use _SET_ command to set these environment variables with your CEMF account:

> SET CEMF_USERNAME=your username
> SET CEMF_PASSWORD=your password

Example:

> SET CEMF_USERNAME =rod@mydomain.com
> SET CEMF_PASSWORD =Abc123def*


### How to Verify if the Environment Variable Exists

To verify if you have existing environment variable set, use _ECHO_ command.

- ECHO %myenvironmentvariable%

Example:

To display the CEMF username or password, use this script.

> ECHO %CEMF_USERNAME%
> ECHO %CEMF_PASSWORD%
<![endif]-->

## Linux and Windows Account Entry

Other improvement brought by this enhancement, it is more interactive with the user by providing the following options:

- Enter the account manually
- Use the previously entered account
- Use the previously entered account to all remaining servers.

Linux and windows servers account are stored separately.

### How It Works

The script store the account information automatically every time the user enter the account in the console. The data is stored in _cemf_settings.json_ file. On the succeeding request and account information is available, the script will ask the user to:

- **Enter the account manually (Default)**. If the user chooses this option, it will allow the user to enter the account. This account will be saved that way it can be used in the next request.
- **Use the previously entered account (Choose: Y)**. If the user chooses this option, it will allow the user to use the previously entered account to save time and minimize error in manually inputting the account. The script will ask again before processing the next server.
- **Use the previously entered account to all remaining servers (Choose: A)**. If the user chooses this option, it will allow the user to use the same server for all succeeding servers in the script.

If the script did not detect account information or it’s your first time to use the script, it will use the default behavior.

### Limitations

Currently the data is stored in _cemf_settings.json_ file are not encrypted. This file is auto-generated by the script once account is inputted.

Sample Data:
{
"linuxUsername": "user",
"linuxPassword": "password",
"linuxHas_key": "N"
...
...
}

**Make sure to manually delete cemf_settings.json file after using the scripts**.

<![endif]-->

## CloudEndure API Token Enahcement

CloudEndure API Token is a key that is use to allows Migration Factory to communicate with CloudEndure through API. There are 5 CEMF scripts that requires you to manually enter the 64 digit CloudEndure API token that is generated by _0-CEProjects.py_ script. User has to copy it manually from the console that way the user can use it in other script that may require it.

### How It Works

When CEMF creates CloudEndure project (_0-CEProjects.py_), it creates CloudEndure project and returns the CloudEndure API token. This token is automatically stored that will be consumed by 5 CEMF scripts that is dependent to CloudEndure API Token.

When CloudEndure API token is detected, it will prompt the user whether to use it or to manually input the CloudEndure API token. If the user choose to use the previously saved token, it will automatically use the token to execute the script else the user is required to manually input the 64 character token.

### Limitations

Currently the CloudEndure API token is stored in _cemf_settings.json_ file and not encrypted. This file is auto-generated by the script once account is inputted.

Sample Data:
{
"CEApiKey": "user",
...
...
}

## Latest update on Intake From CSV (0-Migration-intake-form.csv)

[Latest intake form CSV](https://github.com/awslabs/aws-cloudendure-migration-factory-solution/blob/master/source/automation-scripts.zip) has _aws_account_ column added. If you are still using the old version of intake form, you need to update the _0-Import-intake-form.py_ script with the one in **_workshop_** folder included in this package
